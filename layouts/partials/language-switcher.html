<ul class="language-select">
  {{ $pageLang := .Page.Lang}}
  {{ $translations := .AllTranslations }}
  {{ if not .IsTranslated }}
    {{ $translations = $.Site.Home.AllTranslations }}
  {{ end }}

  {{ range $translations }}
    {{ if eq .Lang $pageLang }}
      <li><span lang="{{ .Lang }}">{{ .Language.LanguageName }}</span></li>
    {{ else }}
      <li><a href="{{ .Permalink }}" lang="{{ .Lang }}">{{ .Language.LanguageName }}</a></li>
    {{ end }}
  {{ end }}
</ul>
