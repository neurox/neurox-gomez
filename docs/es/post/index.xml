<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Posts on JUANING.dev</title><link>https://www.juaning.dev/es/post/</link><description>JUANING.dev (Posts)</description><generator>Hugo -- gohugo.io</generator><language>en-US</language><copyright>JUANING</copyright><lastBuildDate>Thu, 24 Nov 2022 00:00:00 +0000</lastBuildDate><atom:link href="https://www.juaning.dev/es/post/index.xml" rel="self" type="application/rss+xml"/><item><title>Instalar y habilitar acceso FTP en una instancia AWS EC2 con Linux Centos 7</title><link>https://www.juaning.dev/es/post/2022/2022-11-24-install-and-enable-ftp-access-in-aws-ec2-instance-with-linux-centos-7/</link><pubDate>Thu, 24 Nov 2022 00:00:00 +0000</pubDate><guid>https://www.juaning.dev/es/post/2022/2022-11-24-install-and-enable-ftp-access-in-aws-ec2-instance-with-linux-centos-7/</guid><description>&lt;p>Te guiaré a través de la manera más rápida y fácil de configurar el acceso FTP
a una instancia EC2 con la distribución Centos 7 en AWS (Amazon Web Services),
vamos a usar VSFTPD(Very Secure FTP Daemon) asi que el primer paso es instalarlo.&lt;/p>
&lt;h2>Paso 1: Instala VSFTPD&lt;/h2>
&lt;p>1.1 Actualiza el administrador de paquetes:
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-zsh" data-lang="zsh">&lt;span style="display:flex;">&lt;span> sudo yum update&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/p>
&lt;p>1.2 Instala el software VSFTP:
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-zsh" data-lang="zsh">&lt;span style="display:flex;">&lt;span> sudo yum install vsftpd&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/p>
&lt;p>1.3 Inicia el servicio:
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-zsh" data-lang="zsh">&lt;span style="display:flex;">&lt;span> sudo systemctl start vsftpd&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/p>
&lt;p>1.4 Configura el servicio inicie automaticamente cuando cargue el servidor:
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-zsh" data-lang="zsh">&lt;span style="display:flex;">&lt;span> sudo systemctl enable vsftpd&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/p>
&lt;h2>Paso 2: Crea un nuevo usuario FTP&lt;/h2>
&lt;p>2.1 El siguiente comando creara el nuevo usuario:
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-zsh" data-lang="zsh">&lt;span style="display:flex;">&lt;span> sudo adduser ftpuser&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/p>
&lt;p>2.2 Asigna un password para el usuario:
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-zsh" data-lang="zsh">&lt;span style="display:flex;">&lt;span> sudo passwd ftpuser&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/p>
&lt;p>2.3 Agrega el nuevo usuario la lista de usuarios de VSFTP:
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-zsh" data-lang="zsh">&lt;span style="display:flex;">&lt;span> echo &lt;span style="color:#e6db74">&amp;#34;ftpuser&amp;#34;&lt;/span> | sudo tee -a /etc/vsftpd/user_list&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/p>
&lt;h2>Paso 3: Configura VSFTPD&lt;/h2>
&lt;p>3.1 Primero, crea una copia de respaldo del archivo de configuración:
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-zsh" data-lang="zsh">&lt;span style="display:flex;">&lt;span> sudo cp /etc/vsftpd/vsftpd.conf /etc/vsftpd/vsftpd.conf.default&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/p>
&lt;p>3.2 Abre el archivo de configuración con vim:
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-zsh" data-lang="zsh">&lt;span style="display:flex;">&lt;span> sudo nano /etc/vsftpd/vsftpd.conf&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/p>
&lt;p>3.3 Busca las siguientes variables en el archivo y actualizalas como se muestra a continuación:&lt;br>
&lt;strong>Nota:&lt;/strong> Es probable que algunas de las variables no existan, solo agregalas al final de archivo.
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-zsh" data-lang="zsh">&lt;span style="display:flex;">&lt;span> anonymous_enable&lt;span style="color:#f92672">=&lt;/span>NO
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> local_enable&lt;span style="color:#f92672">=&lt;/span>YES
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> write_enable&lt;span style="color:#f92672">=&lt;/span>YES
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> chroot_local_user&lt;span style="color:#f92672">=&lt;/span>YES
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> allow_writeable_chroot&lt;span style="color:#f92672">=&lt;/span>YES
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> userlist_enable&lt;span style="color:#f92672">=&lt;/span>YES
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> userlist_file&lt;span style="color:#f92672">=&lt;/span>/etc/vsftpd/user_list
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> userlist_deny&lt;span style="color:#f92672">=&lt;/span>NO&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/p>
&lt;p>3.4 Reinicia el servicio:
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-zsh" data-lang="zsh">&lt;span style="display:flex;">&lt;span> sudo systemctl restart vsftpd&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/p>
&lt;h2>Paso 4: Crea una carpeta para el nuevo usuario&lt;/h2>
&lt;p>4.1 Crea la carpeta dentro del directorio raiz del usuario:
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-zsh" data-lang="zsh">&lt;span style="display:flex;">&lt;span> sudo mkdir -p /home/ftpuser/ftp/upload&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/p>
&lt;p>4.2 Asigna los permsisos de acceso de la siguiente manera:
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-zsh" data-lang="zsh">&lt;span style="display:flex;">&lt;span> sudo chmod &lt;span style="color:#ae81ff">550&lt;/span> /home/ftpuser/ftp
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> sudo chmod &lt;span style="color:#ae81ff">750&lt;/span> /home/ftpuser/ftp/upload
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> sudo chown -R ftpuser: /home/ftpuser/ftp&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/p>
&lt;h2>Solución de problemas:&lt;/h2>
&lt;h3>Problema 1: Acceso denegado(Access Denied)&lt;/h3>
Por defecto, las instancias Linux EC2 de AWS solo admiten conexion por ssh con una llave privada,
esto significa que para conectarte debes de usar un comando como el siguiente:
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-zsh" data-lang="zsh">&lt;span style="display:flex;">&lt;span> ssh -i your-private-key.pem username@ec2_ip_address&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>
&lt;p>1.1 Edita el archivo sshd_config:
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-zsh" data-lang="zsh">&lt;span style="display:flex;">&lt;span> sudo vi /etc/ssh/sshd_config&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/p>
&lt;p>1.2 Agrega las siguientes lineas al final del archivo:
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-zsh" data-lang="zsh">&lt;span style="display:flex;">&lt;span> Match User ftpuser
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> PasswordAuthentication yes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ChrootDirectory /home/ftpuser/ftp&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/p>
&lt;p>1.3 Reinicia el servicio:
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-zsh" data-lang="zsh">&lt;span style="display:flex;">&lt;span> sudo service sshd restart&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/p></description></item></channel></rss>